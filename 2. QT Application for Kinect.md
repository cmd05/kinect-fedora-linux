
Now that we have our Kinect up and running, we can run our own code to interface with the Kinect and (hopefully) do some useful stuff.

This guide is based on [this](https://www.kdab.com/setting-up-kinect-for-programming-in-linux-part-2/) guide by KDAB on running a QT Application which records a "push" gesture from our hand. The guide also explains the code so you can write your own applications for the Kinect.

# Overview

![](./_assets/kinect-qt.mp4)

> - The grey rectangle on the top of the window is a representation of the Kinect scene.
> - The white rectangle represents your hand, it has a label attached showing it’s current coordinates. _shake your hand in front of the Kinect for it to be recognized_
> - Every time you’ll  “push”, a (randomly colored) circle will appear where your hand is.
> - The bottom left panel shows messages generated by the different libraries.
> - The bottom right panel allow you to modify the current physical state of the Kinect (switch the led, tilt the head)
> - You can reset the view (remove colored circles) by clicking on the “clear preview” button

# Requirements

## libusb Permissions

If you get an error like that: `libusb couldn’t open USB device /dev/bus/usb/001/006: Permission denied.` follow the following procedure (found [here](http://openkinect.org/wiki/Getting_Started)):

```bash
sudo adduser $USER video
sudo nano /etc/udev/rules.d/51-kinect.rules
```

then copy the following lines in the file:

```
# ATTR{product}=="Xbox NUI Motor" SUBSYSTEM=="usb", ATTR{idVendor}=="045e", ATTR{idProduct}=="02b0", MODE="0666"
# ATTR{product}=="Xbox NUI Audio" SUBSYSTEM=="usb", ATTR{idVendor}=="045e", ATTR{idProduct}=="02ad", MODE="0666"
# ATTR{product}=="Xbox NUI Camera" SUBSYSTEM=="usb", ATTR{idVendor}=="045e", ATTR{idProduct}=="02ae", MODE="0666"
```

Be sure to log out and back in.

## Qt Installation

Install qt-4 with the command:

```bash
sudo dnf install qt-devel # ensure that it is qt-4
```

Now, test `qmake-qt4`:

```bash
aquila@fedora:~$ qmake-qt4 
Usage: qmake-qt4 [mode] [options] [files]
```

# How to Build

## Getting the Source Code

Download the demo application source code from [here](http://www.kdab.com/wp-content/uploads/stories/QtKinectExample.tar.gz) to our `~/KinectLibs` folder which we used in the last guide. Extract the `.tar.gz` file to the same folder. 

Now go to the extracted folder:

```bash
aquila@fedora:~/KinectLibs$ cd QtKinectExample
```

## Building

Replace the contents of `QtKinectExample.pro` with the following content. Replace the include and library directories to the relevant paths in your system:

```
TEMPLATE = app
TARGET = 
DEPENDPATH += .

LIBS += -L/home/aquila/KinectLibs/OpenNI/Platform/Linux/Bin/x64-Release -lOpenNI
LIBS += -L/home/aquila/KinectLibs/NITE-Bin-Dev-Linux-x64-v1.5.2.23/Bin -lXnVNite_1_5_2
LIBS += -L/home/aquila/KinectLibs/libfreenect/build/lib -lfreenect

INCLUDEPATH += .
INCLUDEPATH += /home/aquila/KinectLibs/OpenNI/Include/ 
INCLUDEPATH += /home/aquila/KinectLibs/NITE-Bin-Dev-Linux-x64-v1.5.2.23/Include
INCLUDEPATH += /home/aquila/KinectLibs/libfreenect/include

# Input
HEADERS += callBacks.h QtKinect.h QtKinect_global.h QtKinectExample.h
FORMS += QtKinectExample.ui
SOURCES += main.cpp QtKinect.cpp QtKinectExample.cpp
RESOURCES += res.qrc
```

Now build the application:

```bash
aquila@fedora:~/KinectLibs/QtKinectExample$ qmake-qt4
aquila@fedora:~/KinectLibs/QtKinectExample$ make
```

Test the application:

```bash
aquila@fedora:~/KinectLibs/QtKinectExample$ ./QtKinectExample
```

Now, the application should launch. Follow the Overview on how to use the application. 